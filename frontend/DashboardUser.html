<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard User</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
  <style>
    body {
      background-color: #121212;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
    }
    .navbar {
      background-color: #1f1f1f;
      border-bottom: 1px solid #333;
    }
    .navbar-brand, .nav-link, .logout-btn, .btn-profile {
      color: #ffffff !important;
    }
    .btn-profile {
      border: none;
      background: none;
      cursor: pointer;
      font-size: 1rem;
      padding: 0;
    }
    .btn-profile:hover {
      color: #0d6efd !important;
      text-decoration: underline;
    }
    .card {
      background-color: #1e1e1e;
      border: none;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .table {
      color: #ffffff;
    }
    .table thead {
      background-color: #2c2c2c;
    }
    .form-control, .form-select {
      background-color: #2c2c2c;
      border: 1px solid #444;
      color: #fff;
    }
    .btn-view {
      background-color: #0d6efd;
      color: white;
    }
    .btn-cancel {
      background-color: #dc3545;
      color: white;
    }
    .btn-message {
      background-color: #ffc107;
      color: black;
    }
    .btn-logout {
      background-color: #dc3545;
      color: white;
    }
    .greeting-box {
      background-color: #1e1e1e;
      padding: 1rem 1.5rem;
      border-radius: 12px;
      margin-bottom: 1.5rem;
      border-left: 4px solid #0d6efd;
    }
    /* Chat box style floating */
    #chatWindow {
      position: fixed;
      top: 100px;
      right: 20px;
      width: 320px;
      height: 400px;
      background-color: #2c2c2c;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
      z-index: 1050;
      resize: both;
      overflow: hidden;
      user-select: none;
      display: none; /* default hidden */
    }
    #chatHeader {
      padding: 10px 15px;
      background-color: #1e1e1e;
      cursor: move;
      color: white;
      font-weight: 600;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
      border-bottom: 1px solid #444;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
    }
    #chatHeader .close-btn {
      cursor: pointer;
      color: #ccc;
      font-size: 1.2rem;
      transition: color 0.2s;
    }
    #chatHeader .close-btn:hover {
      color: #dc3545;
    }
    #chatBox {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      background-color: #2c2c2c;
      color: #fff;
    }
    .chat-message {
      padding: 6px 10px;
      margin-bottom: 8px;
      background-color: #ffc107;
      border-radius: 8px;
      width: fit-content;
      max-width: 80%;
      color: #000;
      align-self: flex-end;
    }
    .chat-message.doctor {
      background-color: #198754;
      color: white;
      align-self: flex-start;
    }
    #formChat {
      display: flex;
      border-top: 1px solid #444;
      background-color: #1e1e1e;
      padding: 8px;
    }
    #inputPesan {
      flex: 1;
      border: none;
      background-color: #2c2c2c;
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
    }
    #inputPesan:focus {
      outline: none;
      box-shadow: 0 0 5px #0d6efd;
      border-color: #0d6efd;
    }
    #formChat button {
      margin-left: 8px;
      background-color: #0d6efd;
      border: none;
      border-radius: 8px;
      padding: 0 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }
    #formChat button:hover {
      background-color: #0b5ed7;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg px-4 py-3">
    <div class="container-fluid d-flex justify-content-between align-items-center">
      <a class="navbar-brand" href="#"><i class="bi bi-person-circle me-2 text-info"></i>Dashboard User</a>
      <div>
        <button class="btn-profile me-3" id="btnProfileUser" title="Lihat Profil User">
          <i class="bi bi-person"></i> Profil Saya
        </button>
        <a href="#" class="btn btn-sm btn-logout logout-btn"><i class="bi bi-box-arrow-right me-1"></i>Logout</a>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- Ucapan Selamat -->
    <div class="greeting-box">
      <h5 id="greeting">Selamat datang kembali, <span class="text-info">Mikhaii</span>!</h5>
      <small class="text-muted">Hari ini kamu punya 2 jadwal konsultasi.</small>
    </div>

    <!-- Filter dan Search -->
    <div class="d-flex justify-content-between flex-wrap align-items-center mb-4">
      <div class="d-flex gap-2 flex-wrap">
        <input type="text" class="form-control" placeholder="Cari dokter..." style="width: 200px;" />
        <select class="form-select" style="width: 200px;">
          <option selected>Filter Status</option>
          <option value="Pending">Pending</option>
          <option value="ACC">ACC</option>
          <option value="Selesai">Selesai</option>
        </select>
      </div>
    </div>

    <!-- Tabel Jadwal Konsultasi -->
    <div class="card p-4 mb-5">
      <div class="table-responsive">
        <table class="table align-middle table-dark table-hover" id="tabelKonsultasiUser">
          <thead>
            <tr>
              <th>Dokter</th>
              <th>Tanggal</th>
              <th>Keluhan</th>
              <th>Status</th>
              <th>Aksi</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>dr. Mikhaii</td>
              <td>2025-05-23</td>
              <td>Demam dan sakit kepala</td>
              <td class="status">Pending</td>
              <td>
                <button class="btn btn-sm btn-cancel mb-1" title="Batal"><i class="bi bi-x-lg"></i></button>
                <button class="btn btn-sm btn-view mb-1"><i class="bi bi-eye-fill"></i></button>
                <button class="btn btn-sm btn-message mb-1" title="Chat dengan dokter"><i class="bi bi-chat-dots-fill"></i></button>
              </td>
            </tr>
            <tr>
              <td>dr. Daffa</td>
              <td>2025-05-24</td>
              <td>Batuk berkepanjangan</td>
              <td class="status">ACC</td>
              <td>
                <button class="btn btn-sm btn-cancel mb-1" title="Batal"><i class="bi bi-x-lg"></i></button>
                <button class="btn btn-sm btn-view mb-1"><i class="bi bi-eye-fill"></i></button>
                <button class="btn btn-sm btn-message mb-1" title="Chat dengan dokter"><i class="bi bi-chat-dots-fill"></i></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Modal Profil User -->
  <div class="modal fade" id="modalProfilUser" tabindex="-1" aria-labelledby="modalProfilUserLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-white">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="modalProfilUserLabel"><i class="bi bi-person-circle me-2"></i>Profil Saya</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Tutup"></button>
        </div>
        <div class="modal-body">
          <form id="formProfilUser">
            <div class="mb-3">
              <label for="namaUser" class="form-label">Nama Lengkap</label>
              <input type="text" class="form-control" id="namaUser" value="Mikhaii" />
            </div>
            <div class="mb-3">
              <label for="emailUser" class="form-label">Email</label>
              <input type="email" class="form-control" id="emailUser" value="mikhaii@email.com" />
            </div>
            <div class="mb-3">
              <label for="teleponUser" class="form-label">Nomor Telepon</label>
              <input type="tel" class="form-control" id="teleponUser" value="+628123456789" />
            </div>
            <div class="mb-3">
              <label for="alamatUser" class="form-label">Alamat</label>
              <textarea class="form-control" id="alamatUser" rows="2">Jalan Sudirman No.123, Jakarta</textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer border-0">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
          <button type="button" class="btn btn-primary" id="btnSimpanProfilUser">Simpan</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Window -->
  <div id="chatWindow" aria-label="Chat dengan dokter">
    <div id="chatHeader">
      <div><i class="bi bi-chat-dots-fill me-2"></i>Chat Dokter</div>
      <div class="close-btn" id="closeChat" title="Tutup Chat">&times;</div>
    </div>
    <div id="chatBox">
      <div class="chat-message doctor">Halo, ada yang bisa saya bantu?</div>
    </div>
    <form id="formChat" autocomplete="off">
      <input type="text" id="inputPesan" placeholder="Ketik pesan..." />
      <button type="submit"><i class="bi bi-send-fill"></i></button>
    </form>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Greeting based on time
    function updateGreeting() {
      const greetingEl = document.getElementById('greeting');
      const now = new Date();
      const hour = now.getHours();
      let greet = "Selamat datang kembali";

      if (hour >= 4 && hour < 10) {
        greet = "Selamat pagi";
      } else if (hour >= 10 && hour < 15) {
        greet = "Selamat siang";
      } else if (hour >= 15 && hour < 18) {
        greet = "Selamat sore";
      } else if (hour >= 18 || hour < 4) {
        greet = "Selamat malam";
      }

      greetingEl.innerHTML = `${greet}, <span class="text-info">Mikhaii</span>!`;
    }

    updateGreeting();

    // Modal profil user
    const btnProfileUser = document.getElementById('btnProfileUser');
    const modalProfilUser = new bootstrap.Modal(document.getElementById('modalProfilUser'));

    btnProfileUser.addEventListener('click', () => {
      modalProfilUser.show();
    });

    document.getElementById('btnSimpanProfilUser').addEventListener('click', () => {
      alert('Data profil disimpan (simulasi).');
      modalProfilUser.hide();
    });

    // Chat window toggle on message button click
    const chatWindow = document.getElementById('chatWindow');
    const closeChatBtn = document.getElementById('closeChat');
    const tabelKonsultasiUser = document.getElementById('tabelKonsultasiUser');

    tabelKonsultasiUser.addEventListener('click', (e) => {
      if (e.target.closest('.btn-message')) {
        chatWindow.style.display = 'flex';
      } else if (e.target.closest('.btn-cancel')) {
        if (confirm('Apakah Anda yakin ingin membatalkan konsultasi ini?')) {
          const row = e.target.closest('tr');
          row.remove();
          alert('Konsultasi dibatalkan.');
        }
      } else if (e.target.closest('.btn-view')) {
        alert('Menampilkan detail konsultasi (simulasi).');
      }
    });

    closeChatBtn.addEventListener('click', () => {
      chatWindow.style.display = 'none';
    });

    // Chat send message simulation
    const formChat = document.getElementById('formChat');
    const inputPesan = document.getElementById('inputPesan');
    const chatBox = document.getElementById('chatBox');

    formChat.addEventListener('submit', (e) => {
      e.preventDefault();
      const pesan = inputPesan.value.trim();
      if (pesan) {
        const userMsg = document.createElement('div');
        userMsg.classList.add('chat-message');
        userMsg.textContent = pesan;
        chatBox.appendChild(userMsg);
        inputPesan.value = '';
        chatBox.scrollTop = chatBox.scrollHeight;

        // Simulasi balasan dokter
        setTimeout(() => {
          const doctorReply = document.createElement('div');
          doctorReply.classList.add('chat-message', 'doctor');
          doctorReply.textContent = 'Terima kasih atas pesan Anda. Saya akan segera membantu.';
          chatBox.appendChild(doctorReply);
          chatBox.scrollTop = chatBox.scrollHeight;
        }, 1200);
      }
    });
  </script>
</body>
</html>
